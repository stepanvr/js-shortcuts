(function(e){var r={mozilla:/firefox/.test(navigator.userAgent.toLowerCase()),webkit:/webkit/.test(navigator.userAgent.toLowerCase()),opera:/opera/.test(navigator.userAgent.toLowerCase()),msie:/msie/.test(navigator.userAgent.toLowerCase())};var t={backspace:8,tab:9,enter:13,pause:19,capslock:20,esc:27,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,"delete":46,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,"?":191,minus:r.opera?[109,45]:r.mozilla?109:[189,109],plus:r.opera?[61,43]:r.mozilla?[61,107]:[187,107]};var a={};var i;var s={};var n=false;var o=function(r,t){var a=r;if(t.ctrl){a+="_ctrl"}if(t.alt){a+="_alt"}if(t.shift){a+="_shift"}var i=function(e,r){if(r&&r!==16&&r!==17&&r!==18){e+="_"+r}return e};if(e.isArray(t.which)){var s=[];e.each(t.which,function(e,r){s.push(i(a,r))});return s}else{return i(a,t.which)}};var u=function(r){var a={};var i=r.split("+");e.each(i,function(e,r){if(r==="ctrl"||r==="alt"||r==="shift"){a[r]=true}else{a.which=t[r]||r.toUpperCase().charCodeAt()}});return a};var c=function(r){var t=r.tagName.toLowerCase();var a=r.type;return t==="input"&&e.inArray(a,["text","password","file","search"])>-1||t==="textarea"};var f=function(r,t){if(!i){return}var a={ctrl:t.ctrlKey,alt:t.altKey,shift:t.shiftKey,which:t.which};var s=o(r,a);var n=i[s];if(!n){return}var u=c(t.target);var f=false;e.each(n,function(e,r){if(!u||r.enableInInput){if(!f){t.preventDefault();f=true}r.handler(t)}})};e.Shortcuts={};e.Shortcuts.start=function(t){t=t||"default";i=a[t];if(n){return}e(document).bind((r.opera?"keypress":"keydown")+".shortcuts",function(e){if(e.type==="keypress"&&e.which>=97&&e.which<=122){e.which=e.which-32}if(!s[e.which]){f("down",e)}s[e.which]=true;f("hold",e)});e(document).bind("keyup.shortcuts",function(e){s[e.which]=false;f("up",e)});n=true;return this};e.Shortcuts.stop=function(){e(document).unbind("keypress.shortcuts keydown.shortcuts keyup.shortcuts");n=false;return this};e.Shortcuts.add=function(r){if(!r.mask){throw new Error("$.Shortcuts.add: required parameter 'params.mask' is undefined.")}if(!r.handler){throw new Error("$.Shortcuts.add: required parameter 'params.handler' is undefined.")}var t=r.type||"down";var i=r.list?r.list.replace(/\s+/g,"").split(","):["default"];e.each(i,function(i,s){if(!a[s]){a[s]={}}var n=a[s];var c=r.mask.toLowerCase().replace(/\s+/g,"").split(",");e.each(c,function(a,i){var s=u(i);var c=o(t,s);if(!e.isArray(c)){c=[c]}e.each(c,function(e,t){if(!n[t]){n[t]=[]}n[t].push(r)})})});return this};e.Shortcuts.remove=function(r){if(!r.mask){throw new Error("$.Shortcuts.remove: required parameter 'params.mask' is undefined.")}var t=r.type||"down";var i=r.list?r.list.replace(/\s+/g,"").split(","):["default"];e.each(i,function(i,s){if(!a[s]){return true}var n=r.mask.toLowerCase().replace(/\s+/g,"").split(",");e.each(n,function(r,i){var n=u(i);var c=o(t,n);if(!e.isArray(c)){c=[c]}e.each(c,function(e,r){delete a[s][r]})})});return this}})(jQuery);